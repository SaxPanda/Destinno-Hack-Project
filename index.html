<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">
    <link rel="stylesheet" href="assets\css\style.css">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script src="leaflet-search-master\src\leaflet-search.js"></script>
    <link rel="stylesheet" href="leaflet-search-master\src\leaflet-search.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
        crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
        crossorigin=""></script>


    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaft.css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/relases/v5.0.13/css/all.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaftlet-extra-markers@1.0.6/disc/css/leaftlet.extra-markers-min.css"
    />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <style>
        html,
        body {
            height: 100%;
            margin: 0;
        }

        #map {
            width: 600px;
            height: 200px;
        }
    </style>

    <style>
        body {
            padding: 0;
            margin: 0;
        }

        #map {
            height: 100%;
            width: 100vw;
        }
    </style>

</head>

<body>
    <div class="pos-f-t">
        <div class="collapse" id="navbarToggleExternalContent">
            <div class="bg-dark p-4">
                <h5 class="text-white h4">Collapsed content</h5>
                <div class="row">
                    <div class="col-m12 col-sm-12">
                        <span class="text-muted">

                            <a href="https://www.gustazos.com/PR_san-juan">
                                <button>
                                    <img src="https://d18w6sy2vug4bi.cloudfront.net/storage/96000/69139/4707a65e32eafecb97d91b611997d36c.jpg" alt="Girl in a jacket"
                                        style="width:70px;height:60px;">
                                </button>
                            </a>



                            <a href="https://www.gustazos.com/deals/Adventures_kayakadventures8">
                                <button>
                                    <img src="https://d18w6sy2vug4bi.cloudfront.net/storage/96000/69099/cb7c29039a5719dd4206e065e870806f.jpg" alt="Girl in a jacket"
                                        style="width:70px;height:60px;">
                                </button>
                            </a>



                            <a href="https://www.gustazos.com/deals/Hotels_costabahia68">
                                <button>
                                    <img src="https://d18w6sy2vug4bi.cloudfront.net/storage/96000/69700/765260a5d011b77f8aaa52307ef5c40a.png" alt="Girl in a jacket"
                                        style="width:70px;height:60px;">
                                </button>
                            </a>

                        </span>
                    </div>
                </div>
            </div>
        </div>
        <nav class="navbar navbar-dark bg-dark">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </nav>

    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-sm-12">
                <!--    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3784.816494344908!2d-66.0688851850875!3d18.44663918745214!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8c036f4bb9e195e3%3A0xea01edc5a7beebf8!2sColaboratorio+by+Foundation+for+Puerto+Rico!5e0!3m2!1ses-419!2spr!4v1538861807517" frameborder="0" style="border:0" allowfullscreen></iframe>
            -->
                <div id='map'></div>

                <script>


                    var map = L.map('map').setView([18.451603, -66.0599115], 10.2);

                    var t1 = L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
                        maxZoom: 18,
                        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
                            '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
                            'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
                        maxZoom: 18,
                        id: 'mapbox.streets'
                    }).addTo(map);
                    console.log(t1);
                    function onLocationFound(e) {
                        var radius = e.accuracy / 2;

                        L.marker(e.latlng).addTo(map)
                            .bindPopup("You are within " + radius + " meters from this point").openPopup();

                        L.circle(e.latlng, radius).addTo(map);
                    }

                    function onLocationError(e) {
                        alert(e.message);
                    }

                    map.on('locationfound', onLocationFound);
                    map.on('locationerror', onLocationError);
                    let geojson_url = "data\countries.geojson"
                    let geoson_url = "https://babel.webreactiva.com/labs/arboles_singulares_en_espacios_naturales.geojson"
                    let jeson_url = "data\demo route.json"
                    fetch(
                        geojson_url
                    ).then(
                        res => res.json()

                        ).then(
                        data => {
                            let geojsonlayer = L.geoJson(data).addTo(map)
                            map.fitBounds(geojsonlayer())
                        }
                        )


                    fetch(
                        geoson_url
                    ).then(
                        res => res.json()

                        ).then(
                        data => {
                            let geojsonlayer = L.geoJson(data).addTo(map)
                            map.fitBounds(geojsonlayer())
                        }
                        )


                    fetch(
                        jeson_url
                    ).then(
                        res => res.json()

                        ).then(
                        data => {
                            let geojsonlayer = L.geoJson(data).addTo(map)
                            map.fitBounds(geojsonlayer())
                        }
                        )





                    map.locate({ setView: true, maxZoom: 18 });
                </script>
                <script type="text/javascript">


                    $(function () {
                        var params = {
                            // Request parameters
                        console.log("nbvjhgjm");
                            var title = ["Nonna", "To Go Store"];
                            var lati = [18.451603, 18.4516053];
                            var longi = [-66.0599115, -66.0614026];
                        }
                            for(var i = 0; i <= 3; i++) {
                        var name = title[i],
                        var radiusOfBuffer = "0.5",
                        var latitude = lati[i],
                        var longitude = longi[i]



                        $.ajax({
                            url: "https://viewpr.azure-api.net/api/venue?" + $.param(params),
                            beforeSend: function (xhrObj) {
                                // Request headers
                                xhrObj.setRequestHeader("Ocp-Apim-Subscription-Key", "da2da106481e4a1790132548e66e973c ");
                            },
                            type: "GET",
                            // Request body

                        })
                            .done(function (data) {
                                //alert("success");
                                venues = JSON.parse(data);
                                console.log("Cantidad de resultados:" + venues.length);
                                var markers = new L.FeatureGroup();
                                venues.forEach(function (venue) {
                                    console.log(venue.latitude + ", " + venue.longitude);
                                    var marker = L.marker([venue.latitude, venue.longitude], { title: venue.name });
                                    markers.addLayer(marker);
                                })
                                map.addLayer(markers);
                                //
                                //  "name": title[0],
                                //         "radiusOfBuffer": "0.5",
                                //        "latitude": lati[0],
                                //      "longitude": longi[0]
                                var coords = [];
                                for (var x; x < lati.length; x++) {
                                    coords.push([lati[0], longi[0]]);
                                }
                                console.log(coords);
                                coords.push([venues[0].latitude, venues[0].longitude]);
                                L.polyline(coords).addTo(map);
                            })
                            .fail(function () {
                                alert("error");
                            });

                        // });

                    };
            };

                </script>
            </div>

        </div>



    </div>
</body>

</html>